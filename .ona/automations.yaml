services:
  checkout-api:
    name: Checkout API
    description: FastAPI service with a deterministic bug for the Incident Commander AI demo
    triggeredBy:
      - postDevcontainerStart
    commands:
      start: |
        cd app
        python3 -m uvicorn main:app --host localhost --port 8000
      ready: |
        curl -sSf http://localhost:8000/health > /dev/null

tasks:
  run-tests:
    name: Run unit tests
    description: Execute the pytest suite
    triggeredBy:
      - manual
    command: |
      pytest -q

  simulate-incident:
    name: Simulate incident
    description: Trigger the buggy endpoint and generate logs
    triggeredBy:
      - manual
    command: |
      python scripts/simulate_incident.py

  tail-logs:
    name: Tail logs
    description: Display recent application logs for troubleshooting
    triggeredBy:
      - manual
    command: |
      tail -n 50 logs/app.log
