version: 1

services:
  - name: api-server
    description: FastAPI Checkout Service
    command: |
      cd app
      echo "ðŸš€ Starting Checkout API on port 8000..."
      uvicorn main:app --host 0.0.0.0 --port 8000 --reload
    readinessProbe:
      httpGet:
        path: /health
        port: 8000
      initialDelaySeconds: 5
      periodSeconds: 3
      timeoutSeconds: 2
      successThreshold: 1
      failureThreshold: 3

  - name: log-monitor
    description: Monitor application logs
    command: |
      echo "ðŸ“‹ Waiting for logs to be generated..."
      sleep 5
      echo "ðŸ“‹ Tailing application logs (logs/app.log)..."
      tail -f logs/app.log 2>/dev/null || echo "No logs yet. Run the incident simulation to generate logs."
